# 暗黑地牢肉鸽游戏 - 完整需求文档

> **文档版本**：v2.0  
> **创建日期**：2025-01-XX  
> **最后更新**：2025-01-XX  
> **项目状态**：开发中  
> **文档类型**：产品需求文档（PRD）

---

## 📑 文档目录

1. [项目概述](#1-项目概述)
2. [用户需求](#2-用户需求)
3. [功能需求](#3-功能需求)
4. [非功能需求](#4-非功能需求)
5. [界面需求](#5-界面需求)
6. [API需求](#6-api需求)
7. [数据需求](#7-数据需求)
8. [技术需求](#8-技术需求)
9. [测试需求](#9-测试需求)
10. [部署需求](#10-部署需求)
11. [项目规划](#11-项目规划)

---

## 1. 项目概述

### 1.1 项目简介

**暗黑地牢肉鸽**（Dark Dungeon Roguelike）是一款基于 Web 浏览器的暗黑风格地牢探索类游戏。玩家将扮演一名冒险者，在充满危险的地牢中探索、战斗、收集卡牌，通过策略搭配和角色养成，挑战更高难度的地牢。

### 1.2 项目定位

- **游戏类型**：回合制卡牌战斗 + 地牢探索 + 角色养成
- **目标平台**：Web 浏览器（PC端优先，移动端适配中）
- **目标用户**：喜欢策略卡牌游戏和地牢探索的玩家
- **开发模式**：前后端分离，双人团队协作开发
- **技术架构**：现代化全栈技术栈

### 1.3 核心玩法

1. **角色养成**：选择职业、升级技能树、提升角色属性
2. **卡牌收集**：收集角色卡、法术卡、装备卡，构建专属卡组
3. **地牢探索**：挑战不同难度的地牢，获得奖励和资源
4. **策略战斗**：回合制卡牌战斗，需要合理搭配卡组和策略
5. **压力系统**：独特的压力机制，影响角色战斗表现
6. **营地管理**：在营地中购买道具、调整卡组、恢复状态

### 1.4 项目特色

- 🎮 **深度策略**：卡牌组合、角色搭配、技能树选择，多种策略路径
- 🎨 **暗黑风格**：独特的暗黑地牢美术风格和氛围
- 📊 **数据驱动**：完整的游戏数据统计和成就系统
- 🤖 **AI助手**：智能推荐卡组和策略建议
- 🔄 **肉鸽元素**：随机事件、随机掉落，每次探索都有新体验

---

## 2. 用户需求

### 2.1 用户角色

#### 2.1.1 普通玩家
- **描述**：游戏的主要用户群体
- **需求**：
  - 能够注册和登录账号
  - 创建和管理角色
  - 进行地牢探索和战斗
  - 收集卡牌和道具
  - 查看成就和统计数据

#### 2.1.2 管理员（未来扩展）
- **描述**：管理游戏内容和数据
- **需求**：
  - 管理游戏内容（卡牌、敌人、事件等）
  - 查看玩家数据统计
  - 管理商城商品

### 2.2 用户故事

#### 2.2.1 用户注册和登录
- **作为** 新用户
- **我希望** 能够注册账号并登录游戏
- **以便** 开始我的冒险之旅

#### 2.2.2 角色创建
- **作为** 玩家
- **我希望** 能够选择职业并创建角色
- **以便** 开始游戏

#### 2.2.3 地牢探索
- **作为** 玩家
- **我希望** 能够探索地牢并触发随机事件
- **以便** 获得奖励和资源

#### 2.2.4 卡牌战斗
- **作为** 玩家
- **我希望** 能够使用卡牌进行回合制战斗
- **以便** 击败敌人并推进关卡

#### 2.2.5 卡牌收集
- **作为** 玩家
- **我希望** 能够收集和升级卡牌
- **以便** 构建更强大的卡组

#### 2.2.6 营地管理
- **作为** 玩家
- **我希望** 能够在营地中管理角色、卡组和道具
- **以便** 为下次探索做好准备

---

## 3. 功能需求

### 3.1 用户认证模块

#### 3.1.1 用户注册
- **功能描述**：新用户可以通过邮箱和密码注册账号
- **输入**：
  - 账号名称（accountName）
  - 邮箱（email）
  - 密码（password）
- **输出**：
  - 注册成功，返回 JWT Token
  - 注册失败，返回错误信息
- **业务规则**：
  - 邮箱必须唯一
  - 密码长度至少6位
  - 账号名称不能为空
- **状态**：✅ 已实现

#### 3.1.2 用户登录
- **功能描述**：已注册用户可以通过邮箱和密码登录
- **输入**：
  - 邮箱（email）
  - 密码（password）
- **输出**：
  - 登录成功，返回 JWT Token 和用户信息
  - 登录失败，返回错误信息
- **业务规则**：
  - 邮箱和密码必须匹配
  - Token 有效期24小时
- **状态**：✅ 已实现

#### 3.1.3 用户登出
- **功能描述**：用户退出登录
- **输入**：无
- **输出**：登出成功
- **状态**：✅ 已实现

### 3.2 角色管理模块

#### 3.2.1 角色创建
- **功能描述**：玩家选择职业并创建角色实例
- **输入**：
  - 玩家角色模板ID（playerCharacterId）
- **输出**：
  - 创建成功，返回角色实例信息
  - 创建失败，返回错误信息
- **业务规则**：
  - 每个用户只能创建一个角色实例
  - 角色初始属性根据模板计算
- **状态**：✅ 已实现

#### 3.2.2 角色信息查询
- **功能描述**：查询当前用户的角色信息
- **输入**：无（从Token获取用户ID）
- **输出**：角色详细信息（血量、行动点、压力等）
- **状态**：✅ 已实现

#### 3.2.3 角色状态更新
- **功能描述**：更新角色的血量、行动点、压力等状态
- **输入**：
  - 当前血量（currentHp）
  - 当前行动点（currentActionPoints）
  - 当前压力（currentStress）
- **输出**：更新成功
- **状态**：✅ 已实现

### 3.3 卡牌系统模块

#### 3.3.1 卡牌角色管理
- **功能描述**：管理卡牌角色（可上阵的角色卡）
- **功能点**：
  - 获取卡牌角色模板列表（支持职业、阵营、稀有度筛选）
  - 获取用户持有的卡牌角色
  - 卡牌角色上阵/下阵
  - 卡牌角色升星
- **业务规则**：
  - 上阵需要消耗行动点
  - 升星需要消耗3个同名低星角色
- **状态**：✅ 已实现

#### 3.3.2 法术/装备卡管理
- **功能描述**：管理法术卡和装备卡
- **功能点**：
  - 获取卡牌模板列表（支持类型、稀有度筛选）
  - 获取用户手牌
  - 装备/卸下卡牌
- **业务规则**：
  - 装备卡只能装备到卡牌角色上
  - 法术卡不需要装备，直接使用
- **状态**：✅ 已实现

#### 3.3.3 卡牌特性系统
- **功能描述**：卡牌角色拥有特性，影响战斗效果
- **功能点**：
  - 获取卡牌角色的特性列表
  - 特性效果根据星级自动缩放
- **业务规则**：
  - 特性分为正面、负面、中性三种类型
  - 特性效果随星级提升而增强
- **状态**：✅ 已实现

### 3.4 营地系统模块

#### 3.4.1 营地仪表盘
- **功能描述**：聚合显示营地所需的所有数据
- **显示内容**：
  - 玩家主角状态
  - 用户持有的卡牌角色
  - 用户手牌（法术/装备）
  - 背包道具
  - 钱包余额
  - 商城商品
- **状态**：✅ 已实现

#### 3.4.2 卡组管理
- **功能描述**：管理玩家的卡组配置
- **功能点**：
  - 查看所有手牌
  - 筛选和排序卡牌
  - 调整卡组配置
  - 保存多套卡组方案
- **状态**：✅ 已实现

#### 3.4.3 商城系统
- **功能描述**：在营地购买卡牌和道具
- **功能点**：
  - 查看商城商品列表
  - 购买商品（卡牌、道具）
  - 商品刷新机制
- **业务规则**：
  - 购买需要足够的货币
  - 商品按displayOrder排序
- **状态**：✅ 已实现

#### 3.4.4 背包系统
- **功能描述**：管理玩家的道具库存
- **功能点**：
  - 查看背包道具
  - 使用道具
  - 道具堆叠
- **状态**：✅ 已实现

### 3.5 地牢探索模块

#### 3.5.1 关卡系统
- **功能描述**：管理游戏关卡和进度
- **功能点**：
  - 关卡列表展示
  - 关卡解锁机制
  - 章节系统（每5关为一章）
  - Boss关卡标识
- **业务规则**：
  - 第1关默认解锁
  - 通过第N关后解锁第N+1关
  - 每章第5关为Boss关卡
- **状态**：✅ 已实现

#### 3.5.2 探索流程
- **功能描述**：玩家在地牢中探索和触发事件
- **功能点**：
  - 开启探索（创建runs记录）
  - 探索房间
  - 触发随机事件
  - 遭遇敌人
  - 结束探索
- **业务规则**：
  - 探索前需要选择卡组和道具
  - 事件根据触发条件和概率随机触发
- **状态**：✅ 已实现

#### 3.5.3 战斗系统
- **功能描述**：回合制卡牌战斗
- **功能点**：
  - 战斗初始化
  - 回合制战斗流程
  - 卡牌效果执行
  - 战斗结算
- **业务规则**：
  - 玩家和敌人轮流行动
  - 使用卡牌消耗行动点
  - 战斗胜利/失败后更新角色状态
- **状态**：✅ 已实现

### 3.6 技能系统模块

#### 3.6.1 技能树
- **功能描述**：每个职业拥有独立的技能树
- **功能点**：
  - 查看技能树
  - 技能解锁条件检查
  - 解锁技能
- **业务规则**：
  - 技能需要达到指定等级才能解锁
  - 部分技能需要前置技能
  - 技能树按职业区分
- **状态**：✅ 已实现

#### 3.6.2 技能解锁
- **功能描述**：玩家解锁技能
- **输入**：技能ID
- **输出**：解锁成功/失败
- **业务规则**：
  - 检查玩家等级是否满足要求
  - 检查前置技能是否已解锁
- **状态**：✅ 已实现

### 3.7 压力系统模块

#### 3.7.1 压力值管理
- **功能描述**：管理角色的压力值
- **功能点**：
  - 压力值累积
  - 压力层级计算（1-4级）
  - 压力debuff触发
- **业务规则**：
  - 压力值跨关卡持续累积
  - 压力层级越高，debuff越严重
  - 压力debuff根据概率随机触发
- **状态**：✅ 已实现

#### 3.7.2 压力debuff系统
- **功能描述**：压力过高时触发负面效果
- **功能点**：
  - 获取压力debuff配置
  - 根据压力层级显示debuff
  - debuff效果执行
- **业务规则**：
  - debuff分为心理、战斗、行为三种类型
  - 每个压力层级有多个debuff可选
  - debuff效果根据配置执行
- **状态**：✅ 已实现

### 3.8 钱包系统模块

#### 3.8.1 货币管理
- **功能描述**：管理玩家的货币余额
- **功能点**：
  - 查询钱包余额
  - 增加货币
  - 消费货币
- **业务规则**：
  - 支持多种货币类型（金币、魂晶等）
  - 消费时检查余额是否充足
- **状态**：✅ 已实现

### 3.9 成就系统模块

#### 3.9.1 成就查询
- **功能描述**：查询成就列表和完成状态
- **功能点**：
  - 获取所有成就列表
  - 根据分类筛选成就
  - 搜索成就
  - 查看用户成就统计
- **业务规则**：
  - 成就分为进度、精通、收集、社交四类
  - 显示成就完成进度
- **状态**：✅ 已实现

#### 3.9.2 成就完成
- **功能描述**：自动检测并完成成就
- **业务规则**：
  - 系统自动检测成就完成条件
  - 完成时更新用户成就记录
  - 支持成就奖励领取
- **状态**：✅ 已实现（后端）

### 3.10 AI助手模块（待实现）

#### 3.10.1 卡组推荐
- **功能描述**：根据玩家数据和关卡推荐卡组
- **状态**：⏳ 待实现

#### 3.10.2 策略建议
- **功能描述**：提供战斗策略建议
- **状态**：⏳ 待实现

---

## 4. 非功能需求

### 4.1 性能需求

#### 4.1.1 响应时间
- **API响应时间**：95%的API请求响应时间 < 500ms
- **页面加载时间**：首屏加载时间 < 2秒
- **战斗计算**：战斗结算时间 < 1秒

#### 4.1.2 并发性能
- **支持并发用户数**：至少支持100个并发用户
- **数据库连接池**：配置合理的连接池大小

#### 4.1.3 资源占用
- **前端包大小**：生产环境打包后 < 2MB（gzip后）
- **内存占用**：前端运行时内存占用 < 200MB

### 4.2 安全需求

#### 4.2.1 认证安全
- **密码加密**：使用BCrypt加密存储密码
- **JWT Token**：使用HS256算法，有效期24小时
- **Token刷新**：支持Token刷新机制（待实现）

#### 4.2.2 数据安全
- **SQL注入防护**：使用MyBatis Plus参数化查询
- **XSS防护**：前端输入验证和转义
- **CSRF防护**：使用JWT Token验证

#### 4.2.3 接口安全
- **权限验证**：所有需要认证的接口验证Token
- **参数验证**：所有输入参数进行验证
- **错误处理**：不暴露敏感错误信息

### 4.3 可用性需求

#### 4.3.1 浏览器兼容性
- **支持浏览器**：
  - Chrome 90+
  - Firefox 88+
  - Edge 90+
  - Safari 14+
- **移动端**：支持移动端浏览器（响应式设计）

#### 4.3.2 用户体验
- **操作流畅**：所有操作有明确的反馈
- **错误提示**：友好的错误提示信息
- **加载状态**：长时间操作显示加载状态

### 4.4 可维护性需求

#### 4.4.1 代码质量
- **代码规范**：遵循团队代码规范
- **代码注释**：关键逻辑有详细注释
- **代码审查**：所有代码经过审查

#### 4.4.2 文档完整性
- **API文档**：完整的API接口文档
- **数据库文档**：完整的数据库设计文档
- **部署文档**：详细的部署说明

### 4.5 可扩展性需求

#### 4.5.1 架构设计
- **前后端分离**：前后端完全分离，便于独立部署
- **模块化设计**：功能模块化，便于扩展
- **数据库设计**：使用JSON字段支持扩展

#### 4.5.2 功能扩展
- **新卡牌类型**：支持新增卡牌类型
- **新职业**：支持新增职业和技能树
- **新关卡**：支持新增关卡和地牢

---

## 5. 界面需求

### 5.1 页面结构

#### 5.1.1 登录页面
- **功能**：用户登录和注册
- **元素**：
  - 登录表单（邮箱、密码）
  - 注册链接
  - 错误提示区域
- **状态**：✅ 已实现

#### 5.1.2 主页
- **功能**：游戏主入口
- **元素**：
  - 营地入口
  - 技能树入口
  - 成就入口
  - 开始闯关按钮
  - 用户信息显示
- **状态**：✅ 已实现

#### 5.1.3 营地页面
- **功能**：角色管理、卡组管理、商城、背包
- **元素**：
  - 主角面板
  - 卡组管理区域
  - 商城区域
  - 背包区域
  - 钱包显示
- **状态**：✅ 已实现

#### 5.1.4 技能树页面
- **功能**：查看和解锁技能
- **元素**：
  - 技能树可视化
  - 技能详情
  - 解锁按钮
- **状态**：✅ 已实现

#### 5.1.5 战斗页面
- **功能**：回合制卡牌战斗
- **元素**：
  - 战斗区域
  - 手牌区域
  - 角色状态显示
  - 敌人状态显示
  - 操作按钮
- **状态**：✅ 已实现

#### 5.1.6 探索页面
- **功能**：地牢探索和事件触发
- **元素**：
  - 地牢地图
  - 房间节点
  - 事件弹窗
  - 探索进度
- **状态**：✅ 已实现

#### 5.1.7 成就页面
- **功能**：查看成就列表和统计
- **元素**：
  - 成就列表
  - 分类筛选
  - 搜索功能
  - 完成统计
- **状态**：✅ 已实现

### 5.2 UI/UX要求

#### 5.2.1 视觉风格
- **主题**：暗黑风格
- **配色**：深色背景，高对比度文字
- **图标**：使用Font Awesome图标库

#### 5.2.2 交互设计
- **反馈**：所有操作有明确的视觉反馈
- **动画**：适当的过渡动画提升体验
- **响应式**：支持不同屏幕尺寸

#### 5.2.3 可访问性
- **键盘操作**：支持键盘快捷键
- **屏幕阅读器**：关键元素有aria标签（待完善）

---

## 6. API需求

### 6.1 API设计原则

#### 6.1.1 RESTful规范
- **URL设计**：使用RESTful风格
- **HTTP方法**：GET（查询）、POST（创建）、PUT（更新）、DELETE（删除）
- **状态码**：使用标准HTTP状态码

#### 6.1.2 统一响应格式
```json
{
  "code": 200,
  "message": "操作成功",
  "data": {}
}
```

#### 6.1.3 认证方式
- **JWT Token**：在请求头中携带 `Authorization: Bearer {token}`
- **Token获取**：通过登录接口获取

### 6.2 核心API列表

#### 6.2.1 认证模块
- `POST /api/auth/register` - 用户注册
- `POST /api/auth/login` - 用户登录
- `POST /api/auth/logout` - 用户登出

#### 6.2.2 角色模块
- `GET /api/player-characters` - 获取角色模板列表
- `GET /api/user-player-characters` - 获取用户角色
- `POST /api/user-player-characters` - 创建角色
- `PUT /api/user-player-characters/{id}` - 更新角色状态

#### 6.2.3 卡牌模块
- `GET /api/card-characters` - 获取卡牌角色模板
- `GET /api/card-characters/{id}/traits` - 获取角色特性
- `GET /api/user-card-characters` - 获取用户卡牌角色
- `POST /api/user-card-characters/{id}/upgrade-star` - 升星
- `GET /api/cards` - 获取卡牌模板
- `GET /api/user-cards` - 获取用户手牌
- `POST /api/user-cards/{id}/equip` - 装备卡牌

#### 6.2.4 营地模块
- `GET /api/camp/dashboard` - 获取营地仪表盘数据

#### 6.2.5 商城模块
- `GET /api/shop/offers` - 获取商城商品
- `POST /api/shop/purchase` - 购买商品

#### 6.2.6 背包模块
- `GET /api/inventory` - 获取背包
- `POST /api/inventory/{id}/use` - 使用道具

#### 6.2.7 钱包模块
- `GET /api/wallet` - 获取钱包余额
- `POST /api/wallet/add` - 增加货币
- `POST /api/wallet/spend` - 消费货币

#### 6.2.8 技能模块
- `GET /api/skills/{playerCharacterCode}` - 获取技能树
- `GET /api/user-skills` - 获取已解锁技能
- `POST /api/user-skills/unlock` - 解锁技能

#### 6.2.9 地牢模块
- `GET /api/dungeons` - 获取地牢列表
- `POST /api/dungeons/runs/start` - 开启探索
- `GET /api/dungeons/runs/current` - 查询当前探索
- `POST /api/dungeons/runs/{runId}/explore` - 探索房间
- `POST /api/dungeons/runs/{runId}/battle` - 结算战斗
- `POST /api/dungeons/runs/{runId}/end` - 结束探索

#### 6.2.10 关卡模块
- `GET /api/stages` - 获取关卡列表
- `GET /api/user-stage-progress` - 获取关卡进度

#### 6.2.11 压力模块
- `GET /api/stress/status` - 获取压力状态
- `GET /api/stress/debuffs` - 获取压力debuff配置

#### 6.2.12 成就模块
- `GET /api/achievements` - 获取成就列表
- `GET /api/achievements/category/{category}` - 按分类获取
- `GET /api/achievements/{id}` - 获取成就详情
- `GET /api/achievements/user` - 获取用户成就
- `GET /api/achievements/user/stats` - 获取成就统计

### 6.3 API文档

详细的API文档请参考：[API接口文档.md](./API接口文档.md)

---

## 7. 数据需求

### 7.1 数据库设计原则

#### 7.1.1 设计原则
- **模板/实例分离**：区分模板数据（全局）和实例数据（用户）
- **JSON字段扩展**：使用JSON字段支持灵活配置
- **外键约束**：关键关联使用外键约束
- **自增主键**：使用BIGINT自增主键

#### 7.1.2 命名规范
- **表名**：小写，下划线分隔
- **字段名**：小写，下划线分隔
- **索引名**：`idx_` 前缀
- **唯一键**：`uk_` 前缀

### 7.2 核心数据表

#### 7.2.1 用户相关表
- `users` - 用户表
- `user_wallets` - 用户钱包表

#### 7.2.2 角色相关表
- `player_characters` - 玩家角色模板
- `user_player_characters` - 玩家角色实例
- `card_characters` - 卡牌角色模板
- `user_card_characters` - 卡牌角色实例
- `card_character_traits` - 卡牌角色特性

#### 7.2.3 卡牌相关表
- `cards` - 卡牌模板（法术/装备）
- `user_cards` - 用户手牌实例

#### 7.2.4 技能相关表
- `skills` - 技能模板
- `user_player_character_skills` - 用户技能实例

#### 7.2.5 道具相关表
- `items` - 道具模板
- `inventory` - 用户背包

#### 7.2.6 商城相关表
- `shop_offers` - 商城商品

#### 7.2.7 地牢相关表
- `dungeons` - 地牢模板
- `stages` - 关卡模板
- `runs` - 探索记录
- `user_stage_progress` - 用户关卡进度
- `enemies` - 敌人模板
- `enemy_cards` - 敌人卡牌关联
- `enemy_card_characters` - 敌人角色卡关联
- `events` - 随机事件配置

#### 7.2.8 压力相关表
- `stress_debuff_configs` - 压力debuff配置

#### 7.2.9 成就相关表
- `achievements` - 成就模板
- `user_achievements` - 用户成就实例

#### 7.2.10 日志相关表
- `player_actions` - 玩家操作日志

### 7.3 数据关系图

详细的数据库设计请参考：[需求文档.md](./需求文档.md) 第3章

---

## 8. 技术需求

### 8.1 前端技术栈

#### 8.1.1 核心框架
- **Vue 3**：渐进式JavaScript框架
- **TypeScript**：类型安全的JavaScript
- **Vite**：下一代前端构建工具

#### 8.1.2 状态管理
- **Pinia**：Vue 3官方状态管理库

#### 8.1.3 路由
- **Vue Router 4**：Vue官方路由库

#### 8.1.4 UI框架
- **Tailwind CSS**：实用优先的CSS框架
- **Font Awesome**：图标库

#### 8.1.5 HTTP客户端
- **Axios**：Promise based HTTP client

### 8.2 后端技术栈

#### 8.2.1 核心框架
- **Spring Boot 2.7.18**：Java企业级应用框架
- **Java 17**：编程语言

#### 8.2.2 数据访问
- **MyBatis Plus 3.5.2**：MyBatis增强工具
- **MySQL 8.0+**：关系型数据库（开发环境支持H2）

#### 8.2.3 安全框架
- **Spring Security**：安全框架
- **JWT (jjwt 0.11.5)**：JSON Web Token认证

#### 8.2.4 工具库
- **Lombok**：简化Java代码
- **Fastjson2**：JSON处理库

### 8.3 开发工具

#### 8.3.1 版本控制
- **Git**：分布式版本控制系统

#### 8.3.2 构建工具
- **Maven**：Java项目构建工具
- **npm**：Node.js包管理器

#### 8.3.3 IDE推荐
- **IntelliJ IDEA**：Java开发
- **VS Code**：前端开发

### 8.4 部署环境

#### 8.4.1 开发环境
- **前端**：http://localhost:5180
- **后端**：http://localhost:8080
- **数据库**：MySQL 8.0+ 或 H2（开发）

#### 8.4.2 生产环境（待规划）
- **前端**：Nginx静态文件服务
- **后端**：Spring Boot独立运行或Docker容器
- **数据库**：MySQL 8.0+

---

## 9. 测试需求

### 9.1 测试类型

#### 9.1.1 单元测试
- **后端**：使用JUnit进行Service层单元测试
- **前端**：使用Vitest进行组件单元测试（待实现）
- **覆盖率目标**：核心业务逻辑 > 80%

#### 9.1.2 集成测试
- **API测试**：使用Postman/Apifox进行API集成测试
- **数据库测试**：测试数据库操作的正确性

#### 9.1.3 功能测试
- **端到端测试**：测试完整业务流程
- **用户场景测试**：测试典型用户操作流程

#### 9.1.4 性能测试
- **API性能**：测试API响应时间
- **并发测试**：测试系统并发处理能力

### 9.2 测试用例

#### 9.2.1 用户认证测试
- 注册成功/失败场景
- 登录成功/失败场景
- Token验证场景

#### 9.2.2 角色管理测试
- 角色创建测试
- 角色状态更新测试
- 角色查询测试

#### 9.2.3 卡牌系统测试
- 卡牌查询测试
- 卡牌装备测试
- 卡牌升星测试

#### 9.2.4 战斗系统测试
- 战斗流程测试
- 卡牌效果测试
- 战斗结算测试

### 9.3 测试工具

- **Postman/Apifox**：API测试
- **JUnit**：Java单元测试
- **Vitest**：前端单元测试（待配置）

---

## 10. 部署需求

### 10.1 部署架构

#### 10.1.1 开发环境
```
前端 (Vite Dev Server) → 后端 (Spring Boot) → 数据库 (MySQL/H2)
```

#### 10.1.2 生产环境（待规划）
```
Nginx → 前端静态文件
       ↓
   后端API (Spring Boot)
       ↓
    数据库 (MySQL)
```

### 10.2 部署步骤

#### 10.2.1 前端部署
1. 构建生产版本：`npm run build`
2. 将dist目录部署到Nginx
3. 配置Nginx反向代理API请求

#### 10.2.2 后端部署
1. 打包应用：`mvn clean package`
2. 运行JAR文件：`java -jar dark-dungeon-backend.jar`
3. 配置数据库连接
4. 配置JWT密钥

#### 10.2.3 数据库部署
1. 创建数据库
2. 执行建表脚本
3. 导入初始数据

### 10.3 环境配置

#### 10.3.1 前端环境变量
- `VITE_API_BASE_URL`：API基础URL

#### 10.3.2 后端环境变量
- `spring.datasource.url`：数据库连接URL
- `spring.datasource.username`：数据库用户名
- `spring.datasource.password`：数据库密码
- `jwt.secret`：JWT密钥

---

## 11. 项目规划

### 11.1 开发阶段

#### 11.1.1 第一阶段：核心功能（已完成）
- ✅ 用户认证系统
- ✅ 角色管理系统
- ✅ 卡牌系统
- ✅ 营地系统
- ✅ 地牢探索系统
- ✅ 战斗系统
- ✅ 技能系统
- ✅ 压力系统
- ✅ 成就系统

#### 11.1.2 第二阶段：功能完善（进行中）
- ⏳ AI助手功能
- ⏳ 音效系统优化
- ⏳ 动画效果优化
- ⏳ 移动端适配

#### 11.1.3 第三阶段：性能优化（待开始）
- ⏳ 前端性能优化
- ⏳ 后端性能优化
- ⏳ 数据库优化
- ⏳ 缓存机制

#### 11.1.4 第四阶段：扩展功能（待规划）
- ⏳ 多人对战
- ⏳ 社交功能
- ⏳ 排行榜
- ⏳ 活动系统

### 11.2 里程碑

#### 11.2.1 里程碑1：核心功能完成（已完成）
- **时间**：2025-01-XX
- **内容**：完成所有核心功能模块

#### 11.2.2 里程碑2：功能完善（进行中）
- **时间**：2025-02-XX
- **内容**：完善AI助手、优化用户体验

#### 11.2.3 里程碑3：性能优化（待开始）
- **时间**：2025-03-XX
- **内容**：完成性能优化和测试

#### 11.2.4 里程碑4：正式发布（待规划）
- **时间**：2025-04-XX
- **内容**：正式发布v1.0版本

### 11.3 风险与应对

#### 11.3.1 技术风险
- **风险**：前后端接口不匹配
- **应对**：完善API文档，定期联调

#### 11.3.2 进度风险
- **风险**：功能开发延期
- **应对**：合理规划，优先核心功能

#### 11.3.3 质量风险
- **风险**：测试不充分
- **应对**：建立测试流程，提高测试覆盖率

---

## 12. 附录

### 12.1 术语表

| 术语 | 说明 |
|------|------|
| **肉鸽（Roguelike）** | 一种游戏类型，特点是随机生成、永久死亡、回合制战斗 |
| **模板数据** | 静态策划数据，所有玩家共用（如角色模板、卡牌模板） |
| **实例数据** | 玩家持有状态或记录（如玩家角色、玩家卡牌） |
| **压力系统** | 角色在战斗中累积压力，压力过高会触发debuff |
| **行动点** | 每回合可用的行动次数，用于上阵角色或使用卡牌 |
| **星级** | 角色卡的强化等级，通过消耗同名卡牌提升 |
| **关卡（Stage）** | 游戏的基本单位，每关对应一个地牢 |
| **章节（Chapter）** | 每5关为一章，第5关为Boss关卡 |
| **探索模式** | 地牢内的探索状态，可以移动、触发事件 |
| **战斗模式** | 地牢内的战斗状态，回合制卡牌战斗 |

### 12.2 相关文档

- [README.md](./README.md) - 项目总体说明
- [需求文档.md](./需求文档.md) - 详细需求文档（v1.1）
- [API接口文档.md](./API接口文档.md) - RESTful API接口规范
- [开发分工方案.md](./开发分工方案.md) - 团队开发分工指南
- [战斗系统实现方案.md](./战斗系统实现方案.md) - 战斗系统详细实现方案

### 12.3 联系方式

- **项目仓库**：GitHub / GitLab
- **问题反馈**：通过Issue提交
- **开发团队**：2人团队（1后端 + 1前端）

---

**文档维护**：本文档会随着项目开发持续更新，请关注版本历史了解最新变更。

**最后更新**：2025-01-XX  
**文档版本**：v2.0  
**维护者**：项目团队

