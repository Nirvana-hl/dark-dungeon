# å•†åŸæ¥å£é‡æ„è¯´æ˜

## ğŸ“‹ é‡æ„æ¦‚è¿°

**é—®é¢˜**ï¼šè´­ä¹°æ¥å£å’Œå•†åŸæŸ¥è¯¢æ¥å£åœ¨ `CampController` å’Œ `ShopController` ä¸­é‡å¤ï¼Œå¯¼è‡´ä»£ç æ··ä¹±ã€‚

**è§£å†³æ–¹æ¡ˆ**ï¼šç»Ÿä¸€å°†æ‰€æœ‰å•†åŸç›¸å…³æ¥å£è¿ç§»åˆ° `ShopController`ï¼Œåˆ é™¤ `CampController` ä¸­çš„é‡å¤æ¥å£ã€‚

## ğŸ”„ å˜æ›´å†…å®¹

### 1. åˆ é™¤çš„æ¥å£ï¼ˆCampControllerï¼‰

ä»¥ä¸‹æ¥å£å·²ä» `CampController` ä¸­åˆ é™¤ï¼š

- âŒ `GET /camp/shop-offers` - è·å–å•†åŸå•†å“åˆ—è¡¨
- âŒ `GET /camp/shop-offers/{shopType}` - è·å–æŒ‡å®šå•†åº—ç±»å‹çš„å•†å“åˆ—è¡¨
- âŒ `POST /camp/refresh-shop/{shopType}` - åˆ·æ–°å•†åº—
- âŒ `POST /camp/purchase` - è´­ä¹°å•†å“

### 2. ä¿ç•™çš„æ¥å£ï¼ˆShopControllerï¼‰

æ‰€æœ‰å•†åŸç›¸å…³æ¥å£ç°åœ¨ç»Ÿä¸€åœ¨ `ShopController` ä¸­ï¼š

- âœ… `GET /shop/offers` - è·å–å•†åŸå•†å“åˆ—è¡¨ï¼ˆæ‰€æœ‰å•†å“ï¼‰
- âœ… `GET /shop/offers/{shopType}` - è·å–æŒ‡å®šå•†åº—ç±»å‹çš„å•†å“åˆ—è¡¨
- âœ… `POST /shop/refresh/{shopType}` - åˆ·æ–°å•†åº—
- âœ… `POST /shop/purchase` - è´­ä¹°å•†å“

### 3. ShopController æ¥å£æ›´æ–°

#### GET /shop/offers/{shopType}

**æ”¯æŒçš„ shopType**ï¼š
- `card_character` - è§’è‰²å•†åº—
- `spell` - æ³•æœ¯å•†åº—
- `equipment` - è£…å¤‡å•†åº—
- `item` - é“å…·å•†åº—

#### POST /shop/purchase

**æ–°ç‰ˆæœ¬è¯·æ±‚ä½“**ï¼ˆæ¨èï¼‰ï¼š
```json
{
  "offerType": "card_character",
  "targetId": 5,
  "quantity": 1
}
```

**æ—§ç‰ˆæœ¬è¯·æ±‚ä½“**ï¼ˆå…¼å®¹ï¼‰ï¼š
```json
{
  "shopOfferId": 123,
  "quantity": 1
}
```

## ğŸ“ å‰ç«¯éœ€è¦æ›´æ–°çš„åœ°æ–¹

### 1. API è·¯å¾„æ›´æ–°

**éœ€è¦ä¿®æ”¹çš„æ–‡ä»¶**ï¼š`frontend/api/request.ts`

#### ä¿®æ”¹å‰ï¼š
```typescript
// è·å–å•†åº—å•†å“
async getShopOffersByType(shopType: 'item' | 'card' | 'card_character') {
  return await apiClient.get(`/camp/shop-offers/${shopType}`)
}

// è´­ä¹°å•†å“
async purchaseItem(offerId: string, quantity: number = 1) {
  const response = await apiClient.post('/camp/purchase', requestData)
}
```

#### ä¿®æ”¹åï¼š
```typescript
// è·å–å•†åº—å•†å“
async getShopOffersByType(shopType: 'item' | 'card_character' | 'spell' | 'equipment') {
  return await apiClient.get(`/shop/offers/${shopType}`)
}

// è´­ä¹°å•†å“
async purchaseItem(offerId: string, quantity: number = 1) {
  const response = await apiClient.post('/shop/purchase', requestData)
}
```

### 2. åˆ·æ–°å•†åº—æ¥å£

**ä¿®æ”¹å‰**ï¼š
```typescript
POST /camp/refresh-shop/{shopType}
```

**ä¿®æ”¹å**ï¼š
```typescript
POST /shop/refresh/{shopType}
```

## ğŸ¯ æ¶æ„ä¼˜åŠ¿

1. **èŒè´£æ¸…æ™°**ï¼š
   - `CampController` - è¥åœ°èšåˆæ¥å£ï¼ˆä»ªè¡¨ç›˜ã€èƒŒåŒ…ã€äº‹ä»¶ç­‰ï¼‰
   - `ShopController` - å•†åŸä¸“ç”¨æ¥å£ï¼ˆå•†å“æŸ¥è¯¢ã€è´­ä¹°ã€åˆ·æ–°ï¼‰

2. **ä»£ç ç»„ç»‡**ï¼š
   - å•†åŸç›¸å…³åŠŸèƒ½é›†ä¸­åœ¨ä¸€ä¸ª Controller
   - å‡å°‘ä»£ç é‡å¤
   - ä¾¿äºç»´æŠ¤å’Œæ‰©å±•

3. **RESTful è§„èŒƒ**ï¼š
   - `/shop/*` è·¯å¾„æ›´ç¬¦åˆ RESTful è§„èŒƒ
   - æ¥å£å‘½åæ›´æ¸…æ™°

## âš ï¸ æ³¨æ„äº‹é¡¹

1. **å‰ç«¯éœ€è¦æ›´æ–°**ï¼šæ‰€æœ‰è°ƒç”¨ `/camp/shop-offers` å’Œ `/camp/purchase` çš„åœ°æ–¹éƒ½éœ€è¦æ”¹ä¸º `/shop/offers` å’Œ `/shop/purchase`

2. **å…¼å®¹æ€§**ï¼šè´­ä¹°æ¥å£ä»ç„¶æ”¯æŒæ—§ç‰ˆæœ¬çš„ `shopOfferId` å‚æ•°ï¼Œä½†å»ºè®®ä½¿ç”¨æ–°ç‰ˆæœ¬çš„ `offerType` å’Œ `targetId`

3. **CampService**ï¼š`CampService` ä¸­çš„ `getDashboard()` æ–¹æ³•å¦‚æœéœ€è¦åŒ…å«å•†åŸæ•°æ®ï¼Œå¯ä»¥é€šè¿‡è°ƒç”¨ `ShopService` è·å–ï¼Œè€Œä¸æ˜¯åœ¨ `CampController` ä¸­ç›´æ¥å¤„ç†

## ğŸ“Š æ¥å£å¯¹æ¯”è¡¨

| åŠŸèƒ½ | æ—§æ¥å£ï¼ˆCampControllerï¼‰ | æ–°æ¥å£ï¼ˆShopControllerï¼‰ |
|------|-------------------------|------------------------|
| è·å–æ‰€æœ‰å•†å“ | `GET /camp/shop-offers` | `GET /shop/offers` |
| è·å–æŒ‡å®šç±»å‹å•†å“ | `GET /camp/shop-offers/{shopType}` | `GET /shop/offers/{shopType}` |
| åˆ·æ–°å•†åº— | `POST /camp/refresh-shop/{shopType}` | `POST /shop/refresh/{shopType}` |
| è´­ä¹°å•†å“ | `POST /camp/purchase` | `POST /shop/purchase` |

## âœ… å®ŒæˆçŠ¶æ€

- âœ… åˆ é™¤ `CampController` ä¸­çš„å•†åŸæ¥å£
- âœ… æ›´æ–° `ShopController` æ·»åŠ ç¼ºå¤±çš„æ¥å£
- âœ… æ›´æ–° `ShopController` çš„è´­ä¹°æ¥å£æ”¯æŒæ–°ç‰ˆæœ¬å‚æ•°
- â³ å‰ç«¯éœ€è¦æ›´æ–° API è°ƒç”¨è·¯å¾„ï¼ˆå¾…å‰ç«¯ä¿®æ”¹ï¼‰

