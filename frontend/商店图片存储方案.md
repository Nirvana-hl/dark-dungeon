# å•†åº—å›¾ç‰‡å­˜å‚¨å’Œå±•ç¤ºæ–¹æ¡ˆ

## ğŸ“¸ å›¾ç‰‡å­˜å‚¨ä½ç½®å»ºè®®

### æ–¹æ¡ˆä¸€ï¼šé™æ€èµ„æºå­˜å‚¨ï¼ˆæ¨èç”¨äºå¼€å‘é˜¶æ®µï¼‰

**å­˜å‚¨è·¯å¾„ï¼š**
```
frontend/
â”œâ”€â”€ static/
â”‚   â””â”€â”€ images/
â”‚       â””â”€â”€ shop/
â”‚           â”œâ”€â”€ items/          # é“å…·å›¾ç‰‡
â”‚           â”‚   â”œâ”€â”€ item_001.png
â”‚           â”‚   â”œâ”€â”€ item_002.png
â”‚           â”‚   â””â”€â”€ ...
â”‚           â”œâ”€â”€ cards/         # å¡ç‰Œå›¾ç‰‡
â”‚           â”‚   â”œâ”€â”€ card_001.png
â”‚           â”‚   â”œâ”€â”€ card_002.png
â”‚           â”‚   â””â”€â”€ ...
â”‚           â”œâ”€â”€ characters/    # è§’è‰²å›¾ç‰‡
â”‚           â”‚   â”œâ”€â”€ char_001.png
â”‚           â”‚   â”œâ”€â”€ char_002.png
â”‚           â”‚   â””â”€â”€ ...
â”‚           â””â”€â”€ bundles/       # ç¤¼åŒ…å›¾ç‰‡
â”‚               â”œâ”€â”€ bundle_001.png
â”‚               â””â”€â”€ ...
```

**ä½¿ç”¨æ–¹å¼ï¼š**
```vue
<image src="/static/images/shop/items/item_001.png" />
```

### æ–¹æ¡ˆäºŒï¼šåç«¯APIæä¾›å›¾ç‰‡ï¼ˆæ¨èç”¨äºç”Ÿäº§ç¯å¢ƒï¼‰

**åç«¯æ¥å£ï¼š**
- `GET /api/shop/images/{imageId}` - è·å–å•†å“å›¾ç‰‡
- `GET /api/shop/images/item/{itemId}` - è·å–é“å…·å›¾ç‰‡
- `GET /api/shop/images/card/{cardId}` - è·å–å¡ç‰Œå›¾ç‰‡
- `GET /api/shop/images/character/{characterId}` - è·å–è§’è‰²å›¾ç‰‡

**ä½¿ç”¨æ–¹å¼ï¼š**
```vue
<image :src="`/api/shop/images/${offer.imageId}`" />
```

### æ–¹æ¡ˆä¸‰ï¼šCDNå­˜å‚¨ï¼ˆæ¨èç”¨äºå¤§å‹é¡¹ç›®ï¼‰

**å­˜å‚¨ä½ç½®ï¼š**
- é˜¿é‡Œäº‘OSS
- è…¾è®¯äº‘COS
- AWS S3
- ä¸ƒç‰›äº‘

**ä½¿ç”¨æ–¹å¼ï¼š**
```vue
<image :src="offer.imageUrl" />
```

## ğŸ–¼ï¸ å›¾ç‰‡å±•ç¤ºæ–¹å¼

### 1. åŸºç¡€å›¾ç‰‡å±•ç¤º

```vue
<template>
  <view class="product-image">
    <image 
      :src="getProductImage(offer)" 
      :alt="offer.name"
      mode="aspectFit"
      @error="handleImageError"
      class="product-img"
    />
  </view>
</template>

<script setup lang="ts">
function getProductImage(offer: any): string {
  // æ–¹æ¡ˆä¸€ï¼šé™æ€èµ„æº
  if (offer.imagePath) {
    return `/static/images/shop/${offer.imagePath}`
  }
  
  // æ–¹æ¡ˆäºŒï¼šåç«¯API
  if (offer.imageId) {
    return `/api/shop/images/${offer.imageId}`
  }
  
  // æ–¹æ¡ˆä¸‰ï¼šCDN
  if (offer.imageUrl) {
    return offer.imageUrl
  }
  
  // é»˜è®¤å›¾ç‰‡
  return '/static/images/shop/default.png'
}

function handleImageError(event: Event) {
  const img = event.target as HTMLImageElement
  img.src = '/static/images/shop/default.png'
}
</script>
```

### 2. æ‡’åŠ è½½å›¾ç‰‡ï¼ˆæ€§èƒ½ä¼˜åŒ–ï¼‰

```vue
<template>
  <image 
    :src="imageSrc"
    :lazy-load="true"
    :fade-show="true"
    class="lazy-image"
  />
</template>
```

### 3. å›¾ç‰‡å ä½ç¬¦

```vue
<template>
  <view class="image-wrapper">
    <image 
      v-if="imageLoaded"
      :src="imageSrc"
      class="product-image"
    />
    <view v-else class="image-placeholder">
      <i class="fas fa-image"></i>
      <text>åŠ è½½ä¸­...</text>
    </view>
  </view>
</template>
```

## ğŸ“¦ æ•°æ®åº“å­˜å‚¨æ–¹æ¡ˆ

### æ–¹æ¡ˆä¸€ï¼šå­˜å‚¨å›¾ç‰‡è·¯å¾„

```sql
-- åœ¨ shop_offers è¡¨ä¸­æ·»åŠ å›¾ç‰‡å­—æ®µ
ALTER TABLE shop_offers ADD COLUMN image_path VARCHAR(255);
ALTER TABLE shop_offers ADD COLUMN image_url VARCHAR(500);
```

### æ–¹æ¡ˆäºŒï¼šå­˜å‚¨å›¾ç‰‡IDï¼ˆå…³è”å›¾ç‰‡è¡¨ï¼‰

```sql
-- åˆ›å»ºå›¾ç‰‡è¡¨
CREATE TABLE shop_images (
  id BIGINT PRIMARY KEY AUTO_INCREMENT,
  offer_id BIGINT NOT NULL,
  image_type VARCHAR(50), -- 'item', 'card', 'character', 'bundle'
  image_path VARCHAR(255),
  image_url VARCHAR(500),
  display_order INT DEFAULT 0,
  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
  FOREIGN KEY (offer_id) REFERENCES shop_offers(id)
);
```

## ğŸ¨ å›¾ç‰‡è§„æ ¼å»ºè®®

### å•†å“å¡ç‰‡å›¾ç‰‡
- **å°ºå¯¸**: 300x300px æˆ– 400x400px
- **æ ¼å¼**: PNGï¼ˆé€æ˜èƒŒæ™¯ï¼‰æˆ– JPGï¼ˆæœ‰èƒŒæ™¯ï¼‰
- **å¤§å°**: < 200KBï¼ˆä¼˜åŒ–åï¼‰

### å•†å“è¯¦æƒ…å¤§å›¾
- **å°ºå¯¸**: 600x600px æˆ– 800x800px
- **æ ¼å¼**: PNG æˆ– JPG
- **å¤§å°**: < 500KBï¼ˆä¼˜åŒ–åï¼‰

### ç¼©ç•¥å›¾
- **å°ºå¯¸**: 100x100px æˆ– 150x150px
- **æ ¼å¼**: WebPï¼ˆç°ä»£æµè§ˆå™¨ï¼‰æˆ– JPG
- **å¤§å°**: < 50KBï¼ˆä¼˜åŒ–åï¼‰

## ğŸ”§ å›¾ç‰‡ä¼˜åŒ–å»ºè®®

### 1. ä½¿ç”¨ WebP æ ¼å¼
```vue
<image 
  :src="getWebPImage(offer.imagePath)"
  fallback="/static/images/shop/default.jpg"
/>
```

### 2. å“åº”å¼å›¾ç‰‡
```vue
<image 
  :src="offer.imagePath"
  :srcset="`
    ${offer.imagePath}?size=small 300w,
    ${offer.imagePath}?size=medium 600w,
    ${offer.imagePath}?size=large 1200w
  `"
  sizes="(max-width: 768px) 300px, 600px"
/>
```

### 3. å›¾ç‰‡å‹ç¼©
- ä½¿ç”¨å·¥å…·ï¼šTinyPNGã€ImageOptim
- å‹ç¼©ç‡ï¼š70-80%
- ä¿æŒè´¨é‡çš„åŒæ—¶å‡å°æ–‡ä»¶å¤§å°

## ğŸ“ å®ç°æ­¥éª¤

1. **åˆ›å»ºå›¾ç‰‡ç›®å½•ç»“æ„**
   ```bash
   mkdir -p frontend/static/images/shop/{items,cards,characters,bundles}
   ```

2. **æ·»åŠ é»˜è®¤å›¾ç‰‡**
   - å‡†å¤‡ä¸€å¼ é»˜è®¤å ä½å›¾ï¼š`default.png`
   - æ”¾åœ¨ `frontend/static/images/shop/` ç›®å½•

3. **åœ¨ç»„ä»¶ä¸­ä½¿ç”¨**
   ```vue
   <image 
     :src="offer.imagePath || '/static/images/shop/default.png'"
     @error="handleImageError"
   />
   ```

4. **åç«¯è¿”å›å›¾ç‰‡è·¯å¾„**
   - åœ¨ `ShopOfferDTO` ä¸­æ·»åŠ  `imagePath` æˆ– `imageUrl` å­—æ®µ
   - åç«¯æ ¹æ®å•†å“ç±»å‹è¿”å›å¯¹åº”çš„å›¾ç‰‡è·¯å¾„

## ğŸš€ å¿«é€Ÿå¼€å§‹

1. **å°†å›¾ç‰‡æ”¾å…¥æŒ‡å®šç›®å½•**
   ```
   frontend/static/images/shop/items/item_001.png
   ```

2. **åœ¨ä»£ç ä¸­å¼•ç”¨**
   ```vue
   <image src="/static/images/shop/items/item_001.png" />
   ```

3. **æˆ–ä½¿ç”¨åŠ¨æ€è·¯å¾„**
   ```vue
   <image :src="`/static/images/shop/${offer.imagePath}`" />
   ```

## âš ï¸ æ³¨æ„äº‹é¡¹

1. **è·¯å¾„é—®é¢˜**ï¼šç¡®ä¿å›¾ç‰‡è·¯å¾„æ­£ç¡®ï¼Œä½¿ç”¨ç›¸å¯¹è·¯å¾„æˆ–ç»å¯¹è·¯å¾„
2. **è·¨åŸŸé—®é¢˜**ï¼šå¦‚æœä½¿ç”¨CDNï¼Œæ³¨æ„é…ç½®CORS
3. **æ€§èƒ½ä¼˜åŒ–**ï¼šå¤§é‡å›¾ç‰‡æ—¶ä½¿ç”¨æ‡’åŠ è½½å’Œå›¾ç‰‡å‹ç¼©
4. **é”™è¯¯å¤„ç†**ï¼šå§‹ç»ˆæä¾›é»˜è®¤å›¾ç‰‡å’Œé”™è¯¯å¤„ç†
5. **ç§»åŠ¨ç«¯é€‚é…**ï¼šè€ƒè™‘ç§»åŠ¨ç«¯ç½‘ç»œç¯å¢ƒï¼Œä½¿ç”¨é€‚å½“çš„å›¾ç‰‡å°ºå¯¸

